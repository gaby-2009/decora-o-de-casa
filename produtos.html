<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Busca de Produtos com Carrinho</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 2em;
      background: #f9f9f9;
    }

    #search-input {
      width: 250px;
      padding: 8px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    .search-results-list {
      list-style: none;
      margin: 0;
      padding: 0;
      max-height: 300px;
      overflow-y: auto;
      border: 1px solid #ccc;
      background: white;
      position: absolute;
      width: 250px;
      z-index: 10;
    }

    .search-results-list li {
      padding: 8px;
      cursor: pointer;
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .search-results-list li:hover,
    .search-results-list li:focus {
      background-color: #f0f0f0;
      outline: none;
    }

    .search-results-list img {
      width: 48px;
      height: 48px;
      object-fit: cover;
      border-radius: 4px;
    }

    .cart-modal {
      position: fixed;
      top: 10%;
      right: 10%;
      width: 300px;
      background: white;
      border: 1px solid #ccc;
      padding: 1em;
      z-index: 20;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      border-radius: 6px;
    }

    .hidden {
      display: none;
    }

    #cart-list {
      list-style: none;
      padding-left: 0;
      max-height: 200px;
      overflow-y: auto;
      margin-bottom: 1em;
    }

    #cart-list li {
      padding: 4px 0;
      border-bottom: 1px solid #ddd;
    }

    #close-cart-btn {
      float: right;
      background: #e74c3c;
      border: none;
      color: white;
      padding: 5px 10px;
      cursor: pointer;
      border-radius: 4px;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <label for="search-input">Buscar produtos:</label><br />
  <input
    id="search-input"
    type="search"
    placeholder="Busque por produtos..."
    autocomplete="off"
  />
  <ul id="search-results" class="search-results-list"></ul>

  <!-- Modal do carrinho -->
  <div id="cart-modal" class="cart-modal hidden" role="dialog" aria-modal="true" aria-labelledby="cart-title">
    <button id="close-cart-btn" aria-label="Fechar carrinho">X</button>
    <h2 id="cart-title">Carrinho</h2>
    <ul id="cart-list"></ul>
    <div><strong>Total:</strong> R$ <span id="cart-total">0,00</span></div>
  </div>

  <script>
    const produtos = [
       { nome: "Cadeira Elegante", preco: 299.90, imagem: "c10223f411c47646f95ae8fa73fdd033.jpg" }, 
       { nome: "Mesa de Centro", preco: 499.00, imagem: "3defe37aea1ea4b6525aa8893a2d1877.jpg" }, 
       { nome: "Poltrona", preco: 199.99, imagem: "0c1a0af9d7a10f13f3df49d386b0fe2a.jpg" },
       { nome: "Mesa Lateral", preco: 1308.00, imagem: "" }, 
       { nome: "Sofá Redondo", preco: 2000.00, imagem: "https://i.pinimg.com/736x/76/b9/32/76b9324d0b90a14f2a1465f8c8973e60.jpg" },
       { nome: "Rede Cadeira de Balanço", preco: 899.90, imagem: "https://i.pinimg.com/736x/89/19/8f/89198f377db9112b728cfdc8646cb2a5.jpg"},
       { nome: "Recamier Banco Puff com Bau", preco: 550.00, imagem: "https://i.pinimg.com/736x/5e/05/5d/5e055d59878b03de8154dd0a4c051581.jpg" }, 
       { nome: "Kit de Nicho", preco: 300.00, imagem: "" }, { nome: "Frigobar", preco: 499.99, imagem: "https://i.pinimg.com/736x/99/2d/74/992d74f391b10d4802fb7b3f01b8b7c2.jpg" }, 
       { nome: "Espelho ondulado", preco: 150.00, imagem: "" }
    ];

    let carrinho = [];

    const searchInput = document.getElementById('search-input');
    const searchResults = document.getElementById('search-results');
    const cartModal = document.getElementById('cart-modal');
    const cartList = document.getElementById('cart-list');
    const cartTotal = document.getElementById('cart-total');
    const closeCartBtn = document.getElementById('close-cart-btn');

    function atualizarModal() {
      cartList.innerHTML = '';
      let total = 0;

      carrinho.forEach(item => {
        const li = document.createElement('li');
        li.textContent = `${item.nome} - ${item.quantidade}x - R$ ${(item.preco * item.quantidade).toFixed(2).replace('.', ',')}`;
        cartList.appendChild(li);
        total += item.preco * item.quantidade;
      });

      cartTotal.textContent = total.toFixed(2).replace('.', ',');
    }

    function adicionarProduto(nome, preco) {
      const idx = carrinho.findIndex(p => p.nome === nome);
      if (idx >= 0) {
        carrinho[idx].quantidade++;
      } else {
        carrinho.push({ nome, preco, quantidade: 1 });
      }
      atualizarModal();
    }

    function buscarProdutos() {
      const termo = searchInput.value.trim().toLowerCase();
      searchResults.innerHTML = '';

      if (!termo) return;

      const resultados = produtos.filter(p => p.nome.toLowerCase().includes(termo));

      if (resultados.length === 0) {
        searchResults.innerHTML = '<li>Nenhum produto encontrado.</li>';
        return;
      }

      resultados.forEach(p => {
        const li = document.createElement('li');
        li.tabIndex = 0;
        li.innerHTML = `
          <img src="${p.imagem}" alt="${p.nome}" />
          <div>
            <strong>${p.nome}</strong><br />
            <small>R$ ${p.preco.toFixed(2).replace('.', ',')}</small>
          </div>
        `;

        li.addEventListener('click', () => {
          adicionarProduto(p.nome, p.preco);
          cartModal.classList.remove('hidden');
          searchResults.innerHTML = '';
          searchInput.value = '';
        });

        li.addEventListener('keydown', e => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            li.click();
          }
        });

        searchResults.appendChild(li);
      });
    }

    searchInput.addEventListener('input', buscarProdutos);

    closeCartBtn.addEventListener('click', () => {
      cartModal.classList.add('hidden');
    });

    // Fechar modal com ESC
    window.addEventListener('keydown', e => {
      if (e.key === 'Escape' && !cartModal.classList.contains('hidden')) {
        cartModal.classList.add('hidden');
      }
    });
  </script>

</body>
</html>
